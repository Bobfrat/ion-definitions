name: discovery

docstring: |
   The Discovery service supports finding resources by metadata attributes, potentially applying semantic reasoning

spec: https://confluence.oceanobservatories.org/display/syseng/CIAD+DM+OV+Discovery+Service

dependencies: [resource_registry,catalog_management, index_management]

methods:
  create_view:
    docstring: |
      Creates a view which has the specified search fields, the order in which the search fields are presented
      to a query and a term filter.
      @param view_name Name of the view
      @param description Simple descriptive sentence
      @param fields Search fields
      @param order List of fields to determine order of precendence in which the results are presented
      @param filter Simple term filter
    
    in:
      view_name:   ""
      description: ""
      fields:      []
      order:       []
      filters:     ""
    out:
      view_id:     ""


  read_view:
    in:
      view_id:     ""
    out:
      view:        !View

  update_view:
    in:
      view:        !View
    out:
      success:     True
  
  delete_view:
    in:
      view_id:     ""
    out:
      success:     True

  list_catalogs:
    in:
      view_id:     ""
    out:
      catalogs:    []
  # -----------------
  # --- Query Methods ---

  query:
    in: 
      query: !SearchQuery
    out:
      results: {}

  query_couch:
    docstring: |
      Queries against a CouchDBIndex are performed here.  
    in: 
      index_id: ""
      key:      ""
      limit:    0
      offset:   0
      id_only:  True
    out:
      results:  [] 

  traverse:
    docstring: Breadth-first traversal of the association graph for a specified resource.
    in:
      resource_id: ""
    out:
      resources: []

  intersect:
    docstring: The intersection between two sets of resources.
    in:
      left: []
      right: []
    out:
      result: []

  union:
    dosctring: The union between two sets of resources.
    in: 
      left: []
      right: []
    out:
      result: []

  parse:
    dosctring: |
      Parses a given string request and assembles the query, processes the query and returns the results of the query.
    in: 
      search_request: ''
    out:
      success: []

  query_request:
    docstring: Processes a single portion of a query.
    in: 
      query: {}
      limit: 0
      id_only: False
    out:
      results: []

  query_term:
    docstring: Processes a term search query.
    in:
      source_id: ""
      field: ""
      value: ""
      order: {}
      limit: 0
      offset: 0
      id_only: False
    out:
      results: []

  query_range:
    docstring: Processes a range query.
    in:
      source_id: ""
      field: ""
      from_value: Null
      to_value: Null
      order: {}
      limit: 0
      offset: 0
      id_only: False
    out:
      results: []

  query_association:
    docstring: Proccesses an association query.
    in:
      resource_id: ""
      id_only: False
    out:
      results: []

  query_collection:
    docstring: Processes a collection query.
    in:
      collection_id: ""
      id_only: False
    out:
      results: []

  request:
    docstring: |
      Temporary method exposure for client testing purposes.
    in:
      query: {}
      id_only: True
    out:
      results: []

      
